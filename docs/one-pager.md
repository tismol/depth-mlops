#  One-pager

## Бизнес-задача и ценность
**Что делает:** по входному RGB-изображению строит **depth-карту** (оценку относительной глубины сцены в метрах) и отдает результат в форматах **PNG (preview)** и **NPY (числовая матрица)**.

**Ценность для бизнеса:**
Многие продукты нуждаются в оценке глубины сцены для AR, выделения планов, улучшения сегментации и т.п.  
При этом специализированные сенсоры (LiDAR) и полноценные 3D-пайплайны часто слишком дороги и сложны для внедрения.
- **AR/3D**: объекты за людьми/предметами, сегментация по глубине.
- **Робототехника**: оценка препятствий и геометрии сцены при отсутствии LiDAR.

## Модель

В сервисе используется нейросетевая модель для относительной оценки глубины (monocular depth estimation):  
**энкодер - ResNet-50**, инициализированный self-supervised весами **SwAV**; поверх него построен **decoder** (up-sampling + skip-connections), который предсказывает **карту относительной глубины**.

Модель обучена на датасете **NYU Depth v2** (indoor-сцены). На выходе формируется depth-матрица (`float32`) и её PNG-превью (colormap `magma`).


## Что принимает и что возвращает
**Вход:** одиночное изображение или ZIP-архив с изображениями.  
**Поддерживаемые расширения:** `.jpg/.jpeg/.png/.webp`.

**Выход:**
- `depth.png` - псевдоцветная визуализация depth (colormap magma) для быстрого просмотра.
- `depth.npy` - `float32` матрица глубины (224x224), для дальнейшей обработки.

## Технологический стек
- Python 3.11
- FastAPI
- Streamlit
- Postgres 16
- Kafka + Kafka UI
- PyTorch + torchvision + matplotlib
